<ng-container class="bg-white" *ngIf="(appState$ | async) as appState" [ngSwitch]="appState.dataState">
  <ng-container class="bg-white" *ngSwitchCase="DataState.LOADING_STATE">
    <div class="col-md-12 text-center my-3">
      <!--                <div class="spinner-border text-primary my-3" role="status"></div>-->
      <div class="ball-clip-rotate">
        <div style="background-color: rgb(68, 64, 84);"></div>
      </div>
    </div>
  </ng-container>
  <ng-container class="bg-white py-1 px-1" *ngSwitchCase="DataState.LOADED_STATE">
<div class="app-page-title" *ngIf="appState.appData && role.includes('ROLE_SUPERADMIN')">
  <div class="page-title-wrapper">
    <div class="page-title-heading">
      <div class="page-title-icon">
        <i class="pe-7s-user icon-gradient bg-danger">
        </i>
      </div>
      <div>{{appState.appData.firstName | titlecase}}&nbsp;{{appState.appData.lastName | titlecase}}
        <div class="page-title-subheading">{{appState.appData.email}}</div>
      </div>
    </div>
    <div class="page-title-actions">
      <button (click)="back()" type="button" data-toggle="tooltip" title="cartons" data-placement="bottom"
              class="btn-shadow mr-3 btn btn-outline-dark">
           <span class="btn-icon-wrapper pr-2 opacity-7">
                                            <i class="fa fa-backward fa-w-20"></i>
                                        </span>
        Retour
      </button>
    </div>
  </div>
</div>

<ul class="body-tabs body-tabs-layout tabs-animated body-tabs-animated nav" *ngIf="role.includes('ROLE_SUPERADMIN')">
  <li class="nav-item">
    <a role="tab" class="nav-link active" id="tab-0" data-toggle="tab" href="#tab-content-0">
      <span>Détails</span>
    </a>
  </li>
  <li class="nav-item">
    <a role="tab" class="nav-link" id="tab-1" data-toggle="tab" href="#tab-content-1">
      <span>Modifier</span>
    </a>
  </li>
</ul>

<div class="tab-content" *ngIf="role.includes('ROLE_SUPERADMIN')">
  <div class="tab-pane tabs-animation fade show active" id="tab-content-0" role="tabpanel">
    <div class="row">
      <div class="col-md-6">
        <div class="main-card mb-3 card">
          <div class="card-body">
<!--<<<<<<< HEAD-->
            <h5 class="card-title">Référence Interne: </h5>
<!--=======-->
<!--            <h5 class="card-title">Référence Interne: {{appState.appData.internalReference}}</h5>-->
<!--&gt;>>>>>> 37d14d372724acd031f893c0236343c371360e75-->
            <div class="row">
              <div class="col-md-6">
                <div
                  class="vertical-without-time vertical-timeline vertical-timeline--animate vertical-timeline--one-column">
                  <div class="vertical-timeline-item vertical-timeline-element">
                    <div>
<span class="vertical-timeline-element-icon bounce-in">
<i class="badge badge-dot badge-dot-xl badge-success"> </i>
</span>
                      <div class="vertical-timeline-element-content bounce-in">
                        <h4 class="timeline-title">Nom</h4>
                        <p>{{appState.appData.lastName}}
                        </p>
                      </div>
                    </div>
                  </div>
                  <div class="vertical-timeline-item vertical-timeline-element">
                    <div>
<span class="vertical-timeline-element-icon bounce-in">
<i class="badge badge-dot badge-dot-xl badge-success"> </i>
</span>
                      <div class="vertical-timeline-element-content bounce-in">
                        <h4 class="timeline-title">Prénom</h4>
                        <p>{{appState.appData.firstName}}
                        </p>
                      </div>
                    </div>
                  </div>
                  <div class="vertical-timeline-item vertical-timeline-element">
                    <div>
<span class="vertical-timeline-element-icon bounce-in">
<i class="badge badge-dot badge-dot-xl badge-success"> </i>
</span>
                      <div class="vertical-timeline-element-content bounce-in">
                        <h4 class="timeline-title">Email</h4>
                        <p>{{appState.appData.email}}
                        </p>
                      </div>
                    </div>
                  </div>
                  <div class="vertical-timeline-item vertical-timeline-element">
                    <div>
<span class="vertical-timeline-element-icon bounce-in">
<i class="badge badge-dot badge-dot-xl badge-success"> </i>
</span>
                      <div class="vertical-timeline-element-content bounce-in">
                        <h4 class="timeline-title">Téléphone</h4>
                        <p>{{appState.appData.telephone}}
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div
                  class="vertical-without-time vertical-timeline vertical-timeline--animate vertical-timeline--one-column">

                  <div class="vertical-timeline-item vertical-timeline-element">
                    <div>
                      <span class="vertical-timeline-element-icon bounce-in">
                      <i class="badge badge-dot badge-dot-xl badge-success"> </i>
                      </span>
                      <div class="vertical-timeline-element-content bounce-in">
                        <h4 class="timeline-title">Type de compte</h4>
<!--<<<<<<< HEAD-->
                        <p>{{typeAccount}}</p>
<!--=======-->
<!--                        <p>{{getStatusAccount(appState.appData.typeAccount.name)}}</p>-->
<!--&gt;>>>>>> 37d14d372724acd031f893c0236343c371360e75-->
                      </div>
                    </div>
                  </div>
                  <div class="vertical-timeline-item vertical-timeline-element">
                    <div>
<span class="vertical-timeline-element-icon bounce-in">
<i class="badge badge-dot badge-dot-xl badge-success"> </i>
</span>
                      <div class="vertical-timeline-element-content bounce-in">
                        <h4 class="timeline-title">Statut</h4>
<!--<<<<<<< HEAD-->
<!--                        <p>{{statusUser}}-->
<!--=======-->
                        <p [ngClass]="appState.appData.status.name == 'USER_ENABLED' ? 'text-success' : 'text-danger'">{{getStatus(appState.appData.status.name)}}
<!--&gt;>>>>>> 37d14d372724acd031f893c0236343c371360e75-->
                        </p>
                      </div>
                    </div>
                  </div>
                  <div class="vertical-timeline-item vertical-timeline-element">
                    <div>
<span class="vertical-timeline-element-icon bounce-in">
<i class="badge badge-dot badge-dot-xl badge-success"> </i>
</span>
                      <div class="vertical-timeline-element-content bounce-in">
                        <h4 class="timeline-title">Rôle</h4>
                        <p *ngFor="let role of appState.appData.roles">{{getRole(role.name)}}
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <button class="btn btn-primary text-center mt-3" (click)="enableDesable()"
            [disabled]="isLoading$ | async">
              <i *ngIf="isLoading$ | async" class="fa fa-spinner fa-spin"></i>&nbsp;
              <span *ngIf="isLoading$ | async">{{statusUser === "USER_ENABLED" ? 'Désactivation ...' : 'Activation ...'}}</span>
              <span *ngIf="!(isLoading$ | async)">{{statusUser === "USER_ENABLED" ? 'Désactiver' : 'Activer'}}</span>
            </button>

          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="tab-pane tabs-animation fade" id="tab-content-1" role="tabpanel">
    <div class="row">
      <div class="col-md-12">
        <div class="main-card mb-3 card">
          <div class="card-body">
            <h5 class="card-title">Modifier utilisateur</h5>
            <form [formGroup]="updateUser">
              <div class="form-row">
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label>Email</label>
                    <input id="exampleEmail" placeholder="Email..." type="email" name="email"
                           class="form-control form-control-sm"
                           formControlName="email" [(ngModel)]="appState.appData.email">
                  </div>
                  <div *ngIf="form['email'].invalid && (form['email'].dirty || form['email'].touched)"
                       class="mb-2" style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['email'].errors?.['required']" class="ml-3">
                      l'email est obligatoire.
                    </div>
                    <div *ngIf="form['email'].errors?.['email']" class="ml-3">
                      entrez une email valide : example@example.com
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label>Téléphone</label>
                    <input id="telephone" placeholder="téléphone..." type="text" name="telephone"
                           class="form-control form-control-sm"
                           formControlName="telephone" [(ngModel)]="appState.appData.telephone">
                  </div>
                  <div *ngIf="form['telephone'].invalid && (form['telephone'].dirty || form['telephone'].touched)"
                       class="mb-2" style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['telephone'].errors?.['required']" class="ml-3">
                      le numéro de téléphone est obligatoire.
                    </div>
                    <div *ngIf="form['telephone'].errors?.['pattern']" class="ml-3">
                      Le numéro de téléphone doit comporter 9 chiffres commençant par 2 ou par 6
                    </div>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="position-relative form-group">
                    <label>Nom</label>
                    <input id="firstName" placeholder="Nom" type="text" class="form-control form-control-sm"
                           formControlName="firstName"
                           [(ngModel)]="appState.appData.firstName"></div>
                  <div *ngIf="form['firstName'].invalid && (form['firstName'].dirty || form['firstName'].touched)"
                       class="" style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['firstName'].errors?.['required']" class="ml-3">
                      le nom est obligatoire.
                    </div>
                    <div *ngIf="form['firstName'].errors?.['minlength']" class="ml-3">
                      le nom doit comporter au moins 4 caractères..
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="position-relative form-group">
                    <label>Prénom</label>
                    <input id="lastName" placeholder="Prénom" type="text" class="form-control form-control-sm"
                           formControlName="lastName"
                           [(ngModel)]="appState.appData.lastName"></div>
                  <div *ngIf="form['lastName'].invalid && (form['lastName'].dirty || form['lastName'].touched)"
                       class="" style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['lastName'].errors?.['required']" class="ml-3">
                      le prénom est obligatoire.
                    </div>
                    <div *ngIf="form['lastName'].errors?.['minlength']" class="ml-3">
                      le prénom doit comporter au moins 4 caractères..
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="position-relative form-group">
                    <label for="amount">Montant</label>
                    <input id="amount" placeholder="Montant" type="text" class="form-control form-control-sm"
                           formControlName="montant"
                           [(ngModel)]="appState.appData.montant"></div>
                  <div *ngIf="form['montant'].invalid && (form['montant'].dirty || form['montant'].touched)"
                       class="" style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['montant'].errors?.['required']" class="ml-3">
                      le montant est obligatoire.
                    </div>
                    <div *ngIf="form['montant'].errors?.['minlength']" class="ml-3">
                      le montant doit comporter au moins 4 caractères..
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label>Type de compte</label>
                    <select [(ngModel)]="appState.appData.typeAccount.name" formControlName="typeAccount"
                            class="form-control form-control-sm">
                      <option *ngFor="let acc of accounts" value="{{acc.value}}">{{acc.name}}</option>
                    </select>
                  </div>
                  <div *ngIf="form['typeAccount'].invalid && (form['typeAccount'].dirty || form['typeAccount'].touched)"
                       class="" style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['typeAccount'].errors?.['required']" class="ml-3">
                      le nom est obligatoire.
                    </div>
                    <div *ngIf="form['typeAccount'].errors?.['minlength']" class="ml-3">
                      le nom doit comporter au moins 4 caractères...
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label for="role">Rôle</label>
                    <select ngModel="{{appState.appData.roles[0].name}}" id="role" formControlName="roleName" class="form-control form-control-sm">
                      <option value="" selected disabled hidden>Sélectionner un rôle</option>
                      <option *ngFor="let rol of roles" value="{{rol.value}}">{{rol.name}} </option>
                    </select>
                  </div>
                  <div *ngIf="form['roleName'].invalid && (form['roleName'].dirty || form['roleName'].touched)"
                       class=""  style="color: #f65656; font-style: italic;">
                  </div>
                </div>

              </div>
              <div class="form-row">
                <div class="clo">

                  <button type="submit" class="btn btn-primary" [disabled]="updateUser.invalid || (isLoading$ | async)"
                          (click)="onSubmit()">
                    <i *ngIf="isLoading$ | async" class="fa fa-spinner fa-spin"></i>&nbsp;
                    <span *ngIf="isLoading$ | async">Enregistrement...</span>
                    <span *ngIf="!(isLoading$ | async)">Modifier</span>
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  </ng-container>
  <ng-container class="bg-white"  *ngSwitchCase="DataState.ERROR_STATE">
    <div class="col-md-12 text-center">
      <div class="text-danger" >{{appState.error}}</div>
    </div>
  </ng-container>
</ng-container>
